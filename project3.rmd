---
title: "Project 3"
author: "Rachel Fellman & Sabrina Dahl"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(caret)
```

# Introduction

# Data

We will start by reading in the data with the `read_csv` function with a relative path. 

```{r, message=FALSE}
diabetes <- read_csv("diabetes_binary_health_indicators_BRFSS2015.csv")
```

Next we will combine the 1 and 2 groups in the `Education` variable into a new group. We will do this using the `mutate` and `ifelse` functions. The new value for the 1 and 2 groups will just be 1, so `Education` can equal 1, 3, 4, 5, or 6.

```{r}
diabetes.1 <- diabetes %>% 
  mutate(Education = ifelse(Education < 3, 1, Education))
```

# Summarizations

We will start by doing some exploratory data analysis on the full data set. 

Since we will be creating models for different education levels, we will split up the data into smaller data set for each of the 5 education levels to do EDA. 
```{r}
#create education 1 data set
diabetes.ed1 <- diabetes.1 %>% 
  filter(Education ==1)
```

```{r}
#create education 3 data set
diabetes.ed3 <- diabetes.1 %>% 
  filter(Education ==3)
```

```{r}
#create education 4 data set
diabetes.ed4 <- diabetes.1 %>% 
  filter(Education ==4)
```

```{r}
#create education 5 data set
diabetes.ed5 <- diabetes.1 %>% 
  filter(Education ==5)
```

```{r}
#create education 6 data set
diabetes.ed6 <- diabetes.1 %>% 
  filter(Education ==6)
```


We will start by looking at the proportion of people with diabetes across BMI levels. 
```{r}
# group by BMI to create graph of proportion of people with diabetes at each BMI for education 1.
bmi.sum <- diabetes.ed1 %>% 
  group_by(BMI) %>% 
  summarise(proportion.diabetes = mean(Diabetes_binary), n = n())
# create plot
ggplot(bmi.sum, aes(x = BMI, y = proportion.diabetes, size = n)) +
  geom_point(stat = "identity")+ 
#add title
  labs(title = "Proportion of People with Diabetes at each BMI for Education = 1")
```
When looking at this graph is is helpful to look for trends. You can examine the graph to see if there is a positive or negative correlation between the BMI and the proportion of people with diabetes. It can also be good to look for outliers because these may affect our results in unexpected ways. Another aspect to pay attention to would be if there is more data at certain levels of BMI and how this might affect our ability to predict.


Next we will look at a Graph of proportion of Diabetes for different ages. 
```{r}
# group by BMI to create graph of proportion of people with diabetes at each age for education 1.
bmi.sum <- diabetes.ed1 %>% 
  group_by(Age) %>% 
  summarise(proportion.diabetes = mean(Diabetes_binary))
# create plot
ggplot(bmi.sum, aes(x = Age, y = proportion.diabetes)) +
  geom_point(stat = "identity")+ 
#add title
  labs(title = "Proportion of People with Diabetes at each age for Education = 1")
```
When examining this graph, it is helpful to look for trends in the data. For example, do higher ages have higher proportions of diabetes or lower proportions? You can also think about what kind of trend line would best describe the data. Is the relationship linear, parabolic, etc. ?





# Modeling

Before doing any modeling we will split the data into a training and test set using the `createDataPartition` function from the `caret` package. The test/train data will be split with a 70/30 ratio.

```{r}
#make things reproducible with set.seed (I have no idea what number we are supposed to put here because I don't really know what this function does)
set.seed(90)
#create index
train.index <- createDataPartition(diabetes.ed1$Diabetes_binary, p = .7, list = FALSE)
#create train and test sets
diabetes.train <- diabetes.1[train.index, ]
diabetes.test <- diabetes.1[-train.index, ]
```


# Model Selection

